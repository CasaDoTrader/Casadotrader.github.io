<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Casa do Trader</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #c9a227;
            --text: #2d3436;
            --panel-bg: linear-gradient(135deg, #f8f9fa, #e8ecef);
            --shadow: 0 3px 10px rgba(0,0,0,.2);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Roboto, sans-serif;
            background: linear-gradient(135deg, #1c2526, #4a6fa5);
            color: #fff;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            padding: .5rem;
        }
        .container {
            background: rgba(255,255,255,.95);
            padding: .5rem;
            border-radius: 8px;
            max-width: 500px;
            width: 100%;
            border: 1px solid var(--primary);
            box-shadow: var(--shadow);
            text-align: center;
        }
        h1 { font-size: 1.5rem; color: var(--primary); margin-bottom: .5rem; }
        .panel, .totals {
            background: var(--panel-bg);
            padding: .5rem;
            margin: .5rem 0;
            border-radius: 6px;
            border: 1px solid var(--primary);
            box-shadow: var(--shadow);
        }
        .promo, .vagas { color: var(--text); font-size: .75rem; font-weight: 700; margin: .5rem 0; }
        .btn {
            display: inline-block;
            color: #fff;
            padding: .5rem 1rem;
            border-radius: 4px;
            font-size: .8rem;
            font-weight: 700;
            text-decoration: none;
            margin: .3rem;
            box-shadow: var(--shadow);
            transition: filter .2s;
        }
        .btn-quotex { background: var(--primary); }
        .btn-telegram { background: #0088cc; }
        .btn-whatsapp { background: #25D366; }
        .btn:hover { filter: brightness(.9); }
        h2 { color: var(--text); font-size: .9rem; margin-bottom: .5rem; }
        table { width: 100%; border-collapse: collapse; font-size: .7rem; color: var(--text); }
        th, td { padding: .25rem; border-bottom: 1px solid #ddd; }
        th { background: #e8ecef; font-weight: 700; text-align: left; }
        td { text-align: right; }
        th:first-child, td:first-child { text-align: left; font-weight: 700; }
        th:nth-child(2), td:nth-child(2) { text-align: center; min-width: 5rem; }
        .pos { width: 2rem; }
        .totals p { font-size: .75rem; color: var(--text); margin: .2rem 0; }
        @media (max-width: 400px) {
            .container, .panel, .totals { padding: .3rem; margin: .3rem 0; }
            h1 { font-size: 1.3rem; }
            h2, .promo, .vagas { font-size: .65rem; }
            table { font-size: .6rem; }
            .btn { font-size: .7rem; padding: .3rem .6rem; }
            th, td { padding: .2rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Casa do Trader</h1>
        <a href="#" class="btn btn-quotex" onclick="copyToClipboard('cec912eb-c181-40e3-accd-381cdd21ae33','Chave Pix copiada!')">Chave Pix Aleatória</a>
        <a href="https://t.me/+5577998175899" class="btn btn-telegram">Enviar comprovante via Telegram</a>
        <p class="promo">Depósito via Pix, com risco de perda de apenas R$3/dia.</p>
        <p class="vagas">Última vaga disponível! Entre em contato para garantir a sua.</p>
        <a href="https://wa.me/557798175899" class="btn btn-whatsapp">Mentoria</a>
        <a href="https://broker-qx.pro/sign-up/?lid=1328180" class="btn btn-quotex">Cadastre-se na Quotex</a>
        <section class="panel">
            <h2>Relatório de Clientes</h2>
            <table>
                <thead>
                    <tr>
                        <th class="pos">Pos</th>
                        <th>Cliente</th>
                        <th>Crédito</th>
                        <th>Lucro</th>
                        <th>Perda Dia</th>
                        <th>Saldo</th>
                        <th>Sacado</th>
                        <th>Perda Total</th>
                    </tr>
                </thead>
                <tbody id="table-body"></tbody>
            </table>
        </section>
        <section class="totals">
            <h2>Relatório Geral</h2>
            <p><strong>Total dos saldos:</strong> <span id="total-saldos">R$ 0,00</span></p>
            <p><strong>Total sacado:</strong> <span id="total-sacado">R$ 0,00</span></p>
            <p><strong>Total de perdas:</strong> <span id="total-perdas">R$ 0,00</span></p>
        </section>
    </div>
    <script>
        const initialClientsData = [
            {name:"Luzia", deposit:40, profit: 4, daily_loss:0, withdrawn:14.51, total_loss:2.86},
            {name:"Toinha", deposit:20, profit: 15.51, daily_loss:0, withdrawn:0, total_loss:2.86},
            {name:"Isayah", deposit:12, profit: 10.51, daily_loss:0, withdrawn:8, total_loss:2.86},
            {name:"Eunice", deposit:10, profit: 15.51, daily_loss:0, withdrawn:0, total_loss:2.86},
            {name:"Clarice", deposit:11.51, profit: 4, daily_loss:0, withdrawn:0, total_loss:1.36},
            {name:"Domingo", deposit:5, profit: 15.51, daily_loss:0, withdrawn:3, total_loss:2.86},
            {name:"Larissa", deposit:5, profit: 18.51, daily_loss:0, withdrawn:0, total_loss:2.86},
            {name:"Felipe", deposit:5, profit: 21.23, daily_loss:0, withdrawn:0, total_loss:2.86},
            {name:"Kelviane", deposit:5, profit: 6.22, daily_loss:0, withdrawn:0, total_loss:1.36},
            {name:"Zayla", deposit:5, profit: 6.22, daily_loss:0, withdrawn:0, total_loss:1.36},
            {name:"Grazi", deposit:5, profit: 0, daily_loss:0, withdrawn:0, total_loss:1.36},
            {name:"Vaga disponível", deposit:0, profit:0, daily_loss:0, withdrawn:0, total_loss:0}
        ];

        function copyToClipboard(text, message) {
            navigator.clipboard.writeText(text).then(() => alert(message)).catch(() => alert("Erro ao copiar."));
        }

        function roundDown(value) {
            return Math.floor(value * 100) / 100;
        }

        (function() {
            const tableBody = document.getElementById('table-body');
            const totalSaldosElement = document.getElementById('total-saldos');
            const totalSacadoElement = document.getElementById('total-sacado');
            const totalPerdasElement = document.getElementById('total-perdas');
            const clients = JSON.parse(localStorage.getItem('clients')) || initialClientsData;
            let somaSaldos = 0;
            let somaSacado = 0;
            let somaPerdas = 0;

            // Sort and generate table based on data from localStorage (or initial data)
            clients.sort((a, b) => roundDown((b.deposit - b.total_loss) + b.profit) - roundDown((a.deposit - a.total_loss) + a.profit));
            tableBody.innerHTML = clients.map((c, i) => {
                const credit = roundDown(c.deposit - c.total_loss);
                const balance = roundDown(credit + c.profit);
                if (c.name !== "Vaga disponível") {
                    somaSaldos += balance;
                    somaSacado += c.withdrawn;
                    somaPerdas += c.total_loss;
                }
                return `<tr>
                    <td class="pos">${i + 1}º</td>
                    <td>${c.name}</td>
                    <td>R$ ${credit.toFixed(2).replace('.', ',')}</td>
                    <td>R$ ${c.profit.toFixed(2).replace('.', ',')}</td>
                    <td>${c.daily_loss ? `R$ ${c.daily_loss.toFixed(2).replace('.', ',')}` : '-'}</td>
                    <td>R$ ${balance.toFixed(2).replace('.', ',')}</td>
                    <td>R$ ${c.withdrawn.toFixed(2).replace('.', ',')}</td>
                    <td>R$ ${c.total_loss.toFixed(2).replace('.', ',')}</td>
                </tr>`;
            }).join('');

            // Update totals
            totalSaldosElement.textContent = `R$ ${somaSaldos.toFixed(2).replace('.', ',')}`;
            totalSacadoElement.textContent = `R$ ${somaSacado.toFixed(2).replace('.', ',')}`;
            totalPerdasElement.textContent = `R$ ${somaPerdas.toFixed(2).replace('.', ',')}`;

            // We are no longer automatically updating the profit here.
            // Any updates to the data should be handled by other actions
            // that modify the 'clients' array and then save it to localStorage.
        })();
    </script>
</body>
</html>
